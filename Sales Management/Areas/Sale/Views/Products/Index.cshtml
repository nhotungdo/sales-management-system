@model List<Sales_Management.Models.Product>

<div class="card shadow-sm table-container">
    <div class="card-header bg-white py-3 border-0 d-flex justify-content-between align-items-center">
        <h5 class="fw-bold m-0">Danh sách sản phẩm</h5>

        <a asp-area="Sale"
           asp-controller="Products"
           asp-action="Create"
           asp-route-returnUrl="@Url.Action("Index","Home",new{area="Sale"})"
           class="btn btn-primary btn-sm">
            <i class="bi bi-plus-circle"></i> Thêm sản phẩm
        </a>

    </div>

    <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
            <thead class="bg-light text-muted">
                <tr>
                    <th class="ps-4">SẢN PHẨM</th>
                    <th>DANH MỤC</th>
                    <th>GIÁ BÁN</th>
                    <th>SỐ LƯỢNG</th>
                    <th>TRẠNG THÁI</th>
                    <th class="text-end pe-4">THAO TÁC</th>
                </tr>
            </thead>

            <tbody>
                @foreach (var p in Model)
                {
                    var imageUrl = p.ProductImages?
                    .FirstOrDefault(i => i.IsPrimary == true)?.ImageUrl
                    ?? "/images/default-product.png";

                    <tr>
                        <!-- SẢN PHẨM -->
                        <td class="ps-4">
                            <div class="d-flex align-items-center">
                                <img src="@imageUrl"
                                     class="me-3 shadow-sm"
                                     style="width:60px;height:60px;object-fit:contain;" />

                                <div>
                                    <div class="fw-semibold">@p.Name</div>
                                    <small class="text-muted">
                                        Code: @p.Code | ID: #@p.ProductId
                                    </small>
                                </div>
                            </div>
                        </td>

                        <!-- DANH MỤC -->
                        <td>
                            <span class="badge bg-info-subtle text-info px-3">
                                @p.Category?.Name
                            </span>
                        </td>

                        <!-- GIÁ -->
                        <td class="fw-bold">
                            $@p.SellingPrice.ToString("N0")
                        </td>

                        <!-- SỐ LƯỢNG -->
                        <td>
                            @if (p.StockQuantity <= 5)
                            {
                                <span class="text-danger fw-bold">@p.StockQuantity</span>
                            }
                            else
                            {
                                <span class="fw-semibold">@p.StockQuantity</span>
                            }
                        </td>

                        <!-- TRẠNG THÁI -->
                        <td>
                            @if (p.Status == "Active")
                            {
                                <span class="badge bg-success-subtle text-success px-3">
                                    Hoạt động
                                </span>
                            }
                            else
                            {
                                <span class="badge bg-secondary-subtle text-secondary px-3">
                                    Ngừng bán
                                </span>
                            }
                        </td>

                        <!-- THAO TÁC -->
                        <td class="text-end pe-4">
                            <a asp-area="Sale"
                               asp-controller="Products"
                               asp-action="Details"
                               asp-route-id="@p.ProductId"
                               asp-route-returnUrl="@Url.Action("Index","Home",new{area="Sale"})"
                               class="btn btn-sm btn-light border"
                               title="Chi tiết">
                                <i class="bi bi-eye text-info"></i>
                            </a>

                            <a asp-area="Sale"
                               asp-controller="Products"
                               asp-action="Edit"
                               asp-route-id="@p.ProductId"
                               asp-route-returnUrl="@Url.Action("Index","Home",new{area="Sale"})"
                               class="btn btn-sm btn-light border"
                               title="Sửa">
                                <i class="bi bi-pencil text-primary"></i>
                            </a>

                            <a asp-area="Sale"
                               asp-controller="Products"
                               asp-action="Delete"
                               asp-route-id="@p.ProductId"
                               asp-route-returnUrl="@Url.Action("Index","Home",new{area="Sale"})"
                               class="btn btn-sm btn-light border"
                               title="Xóa">
                                <i class="bi bi-trash text-danger"></i>
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
